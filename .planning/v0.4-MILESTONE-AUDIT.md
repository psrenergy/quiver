---
milestone: v0.4
audited: 2026-02-22T20:30:00Z
status: gaps_found
scores:
  requirements: 10/13
  phases: 2/3
  integration: 10/10 (completed phases)
  flows: 2/4
gaps:
  requirements:
    - id: "BIND-01"
      status: "unsatisfied"
      phase: "Phase 7"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "Phase 7 has no directory, no plans, no VERIFICATION.md. Julia wrapper database_csv.jl still uses pre-Phase-6 3-arg signature; will fail at runtime."
    - id: "BIND-02"
      status: "unsatisfied"
      phase: "Phase 7"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "Phase 7 has no directory, no plans, no VERIFICATION.md. Dart wrapper database_csv.dart still uses pre-Phase-6 3-arg signature; quiver_csv_export_options_default() not bound in Dart."
    - id: "BIND-03"
      status: "unsatisfied"
      phase: "Phase 7"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "Phase 7 has no directory, no plans, no VERIFICATION.md. No Lua export_csv binding exists."
  integration:
    - from: "Phase 6 C API"
      to: "Julia wrapper"
      issue: "database_csv.jl passes 3 args to 5-param @ccall — will crash at FFI boundary"
      affects: "BIND-01"
    - from: "Phase 6 C API"
      to: "Dart wrapper"
      issue: "database_csv.dart passes 3 args to 5-param binding — will produce compile/runtime error"
      affects: "BIND-02"
  flows:
    - flow: "Julia export_csv"
      breaks_at: "Julia wrapper -> C FFI boundary (wrong argument count)"
    - flow: "Dart exportCSV"
      breaks_at: "Dart wrapper -> FFI binding boundary (wrong argument count)"
tech_debt: []
---

# v0.4 CSV Export — Milestone Audit

**Audited:** 2026-02-22T20:30:00Z
**Status:** GAPS FOUND
**Score:** 10/13 requirements satisfied

---

## Phase Verification Summary

| Phase | Status | Score | Requirements |
|-------|--------|-------|-------------|
| Phase 5: C++ Core | PASSED | 5/5 criteria | CSV-01, CSV-02, CSV-03, CSV-04, OPT-01, OPT-02, OPT-03, OPT-04 |
| Phase 6: C API | PASSED | 10/10 must-haves | CAPI-01, CAPI-02 |
| Phase 7: Bindings | UNVERIFIED | No directory | BIND-01, BIND-02, BIND-03 (not started) |

---

## 3-Source Requirements Cross-Reference

| REQ-ID | Description | VERIFICATION.md | SUMMARY Frontmatter | REQUIREMENTS.md | Final Status |
|--------|-------------|-----------------|---------------------|-----------------|--------------|
| CSV-01 | export_csv routing (scalars/groups) | SATISFIED (Phase 05) | 05-01, 05-02 | [x] Complete | **satisfied** |
| CSV-02 | RFC 4180 compliant output | SATISFIED (Phase 05) | 05-01, 05-02 | [x] Complete | **satisfied** |
| CSV-03 | Empty collection header-only CSV | SATISFIED (Phase 05) | 05-01, 05-02 | [x] Complete | **satisfied** |
| CSV-04 | NULL values as empty fields | SATISFIED (Phase 05) | 05-01, 05-02 | [x] Complete | **satisfied** |
| OPT-01 | CSVExportOptions struct | SATISFIED (Phase 05) | 05-01, 05-02 | [x] Complete | **satisfied** |
| OPT-02 | Enum resolution with fallback | SATISFIED (Phase 05) | 05-01, 05-02 | [x] Complete | **satisfied** |
| OPT-03 | DateTime formatting via strftime | SATISFIED (Phase 05) | 05-01, 05-02 | [x] Complete | **satisfied** |
| OPT-04 | default_csv_export_options() factory | SATISFIED (Phase 05) | 05-01, 05-02 | [x] Complete | **satisfied** |
| CAPI-01 | Flat FFI struct with parallel arrays | SATISFIED (Phase 06) | 06-01, 06-02 | [x] Complete | **satisfied** |
| CAPI-02 | quiver_database_export_csv() | SATISFIED (Phase 06) | 06-01, 06-02 | [x] Complete | **satisfied** |
| BIND-01 | Julia export_csv wrapper | ORPHANED | missing | [ ] Pending | **unsatisfied** |
| BIND-02 | Dart exportCSV wrapper | ORPHANED | missing | [ ] Pending | **unsatisfied** |
| BIND-03 | Lua export_csv wrapper | ORPHANED | missing | [ ] Pending | **unsatisfied** |

### Orphan Detection

3 requirements (BIND-01, BIND-02, BIND-03) are present in the REQUIREMENTS.md traceability table and assigned to Phase 7, but Phase 7 has no directory, no plans, and no VERIFICATION.md. These are classified as **orphaned** and treated as unsatisfied.

---

## Cross-Phase Integration

### Verified Wiring (Phase 5 -> Phase 6)

All Phase 5 -> Phase 6 integration points are correctly wired:

| From | To | Via | Status |
|------|----|-----|--------|
| `CSVExportOptions` (csv.h) | `src/c/database_csv.cpp` | `convert_options()` reconstructs full map from parallel arrays | WIRED |
| `Database::export_csv()` 4-param | `quiver_database_export_csv()` | `db->db.export_csv(collection, group, path, cpp_opts)` | WIRED |
| `include/quiver/c/csv.h` | `include/quiver/c/database.h` | `#include "csv.h"` at line 5 | WIRED |
| `csv_export.sql` test schema | Both C++ and C API test suites | `VALID_SCHEMA("csv_export.sql")` | WIRED |
| CMake targets | `quiver` (core), `quiver_c` (C API), both test targets | All 4 source files registered | WIRED |
| Old 4-param stub | Removed from `database.cpp` | Replaced by 5-param in `database_csv.cpp` | CLEAN |
| Julia FFI `c_api.jl` | Regenerated with 5-param signature | `quiver_csv_export_options_t` struct + functions | WIRED |
| Dart FFI `bindings.dart` | Regenerated with 5-param signature | `quiver_csv_export_options_t` struct + function | WIRED |

### Flat Struct Field Coverage

| C++ `CSVExportOptions` field | C `quiver_csv_export_options_t` fields | Coverage |
|------------------------------|----------------------------------------|---------|
| `enum_labels` (nested map) | 5 fields: `enum_attribute_names`, `enum_entry_counts`, `enum_values`, `enum_labels`, `enum_attribute_count` | Full — lossless |
| `date_time_format` (string) | `date_time_format` (const char*) | Full |

### Broken Integration (Phase 6 -> Phase 7 boundary)

| From | To | Issue | Affected REQ |
|------|----|-------|-------------|
| C API 5-param signature | Julia `database_csv.jl` | Wrapper passes 3 args to 5-param @ccall | BIND-01 |
| C API 5-param signature | Dart `database_csv.dart` | Wrapper passes 3 args to 5-param binding | BIND-02 |
| `quiver_csv_export_options_default()` | Dart `bindings.dart` | Factory function not bound in Dart FFI | BIND-02 |

---

## E2E Flow Status

| Flow | Status | Break Point |
|------|--------|-------------|
| C++ direct: `db.export_csv(collection, group, path, opts)` | COMPLETE | 19/19 tests pass |
| C API direct: `quiver_database_export_csv(db, col, grp, path, &opts)` | COMPLETE | 19/19 tests pass |
| Julia: `export_csv(db, collection, path)` | BROKEN | `database_csv.jl` passes 3 args to 5-param FFI |
| Dart: `db.exportCSV(collection, path)` | BROKEN | `database_csv.dart` passes 3 args to 5-param FFI |

---

## Tech Debt

No tech debt items found across completed phases. Both Phase 5 and Phase 6 verification reports show zero anti-patterns, zero TODOs/FIXMEs, and no deferred items.

---

## Anti-Patterns

None found in any verified phase.

---

## Build & Test Status (at verification time)

| Check | Result |
|-------|--------|
| C++ tests | 437/437 PASSED |
| C API tests | 282/282 PASSED |
| CSV-specific C++ tests | 19/19 PASSED |
| CSV-specific C API tests | 19/19 PASSED |

---

_Audited: 2026-02-22T20:30:00Z_
_Auditor: Claude (milestone audit workflow)_
